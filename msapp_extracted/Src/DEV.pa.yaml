# ************************************************************************************************
# Warning: YAML source code for Canvas Apps should only be used to review changes made within Power Apps Studio and for minor edits (Preview).
# Use the maker portal to create and edit your Power Apps.
# 
# The schema file for Canvas Apps is available at https://go.microsoft.com/fwlink/?linkid=2304907
# 
# For more information, visit https://go.microsoft.com/fwlink/?linkid=2292623
# ************************************************************************************************
Screens:
  DEV:
    Properties:
      LoadingSpinnerColor: =RGBA(56, 96, 178, 1)
    Children:
      - ButtonCanvas3:
          Control: Button@0.0.45
          Properties:
            OnSelect: |+
              =ClearCollect(
                  colTesteAgressor,
                  AddColumns(
                      Filter(SAVe_Perfil_Agressor, ID_Caso = ItemAtual.ID_Caso),
                      Enderecos,
                      Filter(
                          SAVe_Perfil_Agressor_Endereco,
                          ID_Caso = ItemAtual.ID_Caso &&
                          ID_Perfil_Agressor = ID
                      )
                  )
              );

              /*
              With(
                  { registroJson: ParseJSON(
                          "{""Data"":""2025-02-13"",""Fora_Atribuicao"":""Não"",""Grupo_Tematico"":"""",""Municipio_Origem"":null,""Num_Cadastro"":""312321321""}"
                      ) };
                  Set(
                      Registro;
                      {
                          Data: Text(registroJson.Data);
                          Fora_Atribuicao: Text(registroJson.Fora_Atribuicao);
                          Grupo_Tematico: Text(registroJson.Grupo_Tematico);
                          Municipio_Origem: registroJson.Municipio_Origem;
                          Num_Cadastro: Text(registroJson.Num_Cadastro)
                      }
                  )
              );;*/
            X: =637
            Y: =58
      - ButtonCanvas3_1:
          Control: Button@0.0.45
          Properties:
            OnSelect: |-
              =Set(_meuCargo, "Administrador");
              Set(_modoDesenvolvedor, false);
            Text: ="ADM"
            X: =733
            Y: =275
      - Toggle1:
          Control: Toggle@1.1.5
          Properties:
            Height: =31
            Label: ="Modo DEV"
            OnSelect: =Set(_modoDesenvolvedor, Self.Checked)
            Width: =235
            X: =40
            Y: =40
      - ButtonCanvas4:
          Control: Button@0.0.45
          Properties:
            Height: =58
            OnSelect: =Set(cor, Blank())
            X: =124
            Y: =288
      - Icon2:
          Control: Classic/Icon@2.5.0
          Properties:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =RGBA(0, 18, 107, 1)
            DisplayMode: =DisplayMode.Disabled
            Icon: =Icon.Newspaper
            Tooltip: |-
              ="Redasda"
              /*With(
                  {
                      // todas as linhas do acompanhamento para este caso
                      varAcomp: Filter(SAVe_Acompanhamentos; ID_Caso = ThisItem.ID_Caso)
                  };
                  With(
                      {
                          // cria uma coluna temporária "Resp" contendo a tabela de usuários (Responsaveis) e "desagrupa" tudo numa tabela única
                          varTodosResp: Ungroup(AddColumns(varAcomp; Resp; Responsaveis); Resp)
                      };
                      With(
                          {
                              // tabela de IDs (coluna única) — formato que 'in' espera
                              varIDs: ShowColumns(varTodosResp; Id);
                              // registros da lista de responsáveis apenas da área Direito
                              varDireito: Filter(SAVe_Responsaveis; Area = "Direito")
                          };
                          With(
                              {
                                  // filtra os da lista de responsáveis cuja ID aparece entre os IDs coletados
                                  varMatch: Filter(varDireito; ID in varIDs)
                              };
                              If(
                                  CountRows(varMatch) = 0;
                                  "*Pendente Preenchimento*";
                                  // remove duplicados por Nome e concatena
                                  Concat(Distinct(varMatch; Nome); Value; ", ")
                              )
                          )
                      )
                  )
              )*/
            X: =232
            Y: =176
